<div class="container">
  <h2>ðŸ“‘ Generate Invoice</h2>

  <!-- Coordinator Form -->
  <div id="formSection">
    <label>Institution:</label>
    <select id="institutionSelect">
      <option value="">-- Select Institution --</option>
    </select><br><br>

    <label>Event / Booking:</label>
    <select id="eventSelect" disabled>
      <option value="">-- Select Event --</option>
    </select><br><br>

    <label>Invoice ID:</label>
    <input type="text" id="invoiceId"><br><br>

    <label>Delivery No.:</label>
    <input type="text" id="deliveryNo"><br><br>

    <label>Dated:</label>
    <input type="date" id="dated"><br><br>

    <label>SI No.:</label>
    <input type="text" id="siNo"><br><br>

    <label>Description (Venue + Services):</label>
    <select id="descSelect">
      <option value="">-- Select --</option>
    </select><br><br>

    <label>Amount:</label>
    <input type="number" id="amountInput"><br><br>

    <label>Total Cost:</label>
    <input type="number" id="totalInput"><br><br>

    <button class="btn" onclick="generateInvoice()">Generate Invoice</button>
  </div>

  <!-- Invoice Output -->
  <div id="invoice" class="invoice-box" style="display:none;">
    <div class="header">
      <div>
        <h3>GTEC HOSPITALITY MANAGEMENT SERVICES</h3>
        <p>P.O. BOX MB 28, MINISTRIES â€“ ACCRA</p>
        <p>Contact: 0244202959, 0244660848</p>
        <p>Email: hospitality@gtec.edu.gh</p>
      </div>
      <div class="right">
        <p><b>Invoice No:</b> <span id="invNo"></span></p>
        <p><b>Date:</b> <span id="invDate"></span></p>
      </div>
    </div>

    <h2 style="text-align:center;">INVOICE</h2>

    <table>
      <tr><th>SI No.</th><th>Description</th><th>Amount</th></tr>
      <tr>
        <td id="siCell">-</td>
        <td id="eventDesc">-</td>
        <td id="amount">-</td>
      </tr>
      <tr>
        <td colspan="2" style="text-align:right;"><b>Total</b></td>
        <td id="total">-</td>
      </tr>
    </table>

    <h3>Bank Details</h3>
    <p><b>A/c Holderâ€™s Name:</b> GTEC CONFERENCE</p>
    <p><b>Bank Name:</b> AGRICULTURAL DEVELOPMENT BANK</p>
    <p><b>A/c No.:</b> 0701010009158801</p>
    <p><b>Branch & Bank Code:</b> Gulf House</p>

    <p style="margin-top:30px;"><i>Kindly Note: 50% payment required to secure venue.</i></p>
  </div>

  <button id="downloadBtn" class="btn" style="display:none;">Download PDF</button>
</div>

<script>
const sheetURL = "https://opensheet.elk.sh/2PACX-1vRLDl2oNe9mONdejXYfXqk3hjdVZUWHsfdN47F54BS4nyufgxV_o2VaCm-upReu1ERhZZQ173TfDJ3B/All%20Bookings%20Responses";

async function loadInstitutions() {
    try {
        const response = await fetch(sheetURL);
        const data = await response.json();

        // Get dropdowns
        const institutionSelect = document.getElementById("institution");
        const eventSelect = document.getElementById("event");
        const descriptionSelect = document.getElementById("description");

        // Clear any old options
        institutionSelect.innerHTML = '<option value="">-- Select Institution --</option>';
        eventSelect.innerHTML = '<option value="">-- Select Event --</option>';
        descriptionSelect.innerHTML = '<option value="">-- Select --</option>';

        // Populate institution dropdown
        let institutions = [...new Set(data.map(row => row["Name of Institution/Organization/Person"]))];
        institutions.forEach(inst => {
            let option = document.createElement("option");
            option.value = inst;
            option.textContent = inst;
            institutionSelect.appendChild(option);
        });

        // Listen for Institution selection â†’ load events
        institutionSelect.addEventListener("change", function() {
            let selectedInst = this.value;
            eventSelect.innerHTML = '<option value="">-- Select Event --</option>';

            let filtered = data.filter(row => row["Name of Institution/Organization/Person"] === selectedInst);

            filtered.forEach(row => {
                let option = document.createElement("option");
                option.value = row["Event Description"];
                option.textContent = row["Event Description"];
                eventSelect.appendChild(option);
            });
        });

        // Listen for Event selection â†’ load venue + services
        eventSelect.addEventListener("change", function() {
            let selectedEvent = this.value;
            descriptionSelect.innerHTML = '<option value="">-- Select --</option>';

            let row = data.find(r => r["Event Description"] === selectedEvent);

            if (row) {
                let option1 = document.createElement("option");
                option1.value = row["Venue"];
                option1.textContent = "Venue: " + row["Venue"];
                descriptionSelect.appendChild(option1);

                if (row["Additional Services"]) {
                    let option2 = document.createElement("option");
                    option2.value = row["Additional Services"];
                    option2.textContent = "Services: " + row["Additional Services"];
                    descriptionSelect.appendChild(option2);
                }
            }
        });

    } catch (error) {
        console.error("Error loading sheet data:", error);
    }
}

// Load data on page ready
window.onload = loadInstitutions;
</script>


